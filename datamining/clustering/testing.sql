create table conditions_clusters as
select nct_id,
  max(case when substr(mesh_id,1,7) in ('F04.096','F03.080','C25','C25.100','C25.835','F03.600','C25.675','I01.880','C25.912','C25.300','C25.635','F03.900','F01.145') then 1 else 0 end) clus_0,
  max(case when substr(mesh_id,1,7) in ('C02.825','C02.782','C02.800','C13.351','C17.800','C02.440','C02.256','C20.673','C02','C06.552','C02.839','C01.539','C12.294') then 1 else 0 end) clus_1,
  max(case when substr(mesh_id,1,7) in ('C08.360','C16.320','C10.228','C11.640','C04.588','C17.800','C11.590','C09.647','C09.400','C10.562','C16.131','C10.292') then 1 else 0 end) clus_2,
  max(case when substr(mesh_id,1,7) in ('C11.675','C11.204','C11.496','C16.320','C11.270','C11') then 1 else 0 end) clus_3,
  max(case when substr(mesh_id,1,7) in ('C26.117','C26.531','C26.831','C26.088','C26.558','C26.404') then 1 else 0 end) clus_4,
  max(case when substr(mesh_id,1,7) in ('C16.300','C26.761','C13.703') then 1 else 0 end) clus_5,
  max(case when substr(mesh_id,1,7) in ('A11.284','G05.700','G05.360','G05.365') then 1 else 0 end) clus_6,
  max(case when substr(mesh_id,1,7) in ('C19.700','C10.228','C16.320','C19.297','C19','C05.116') then 1 else 0 end) clus_7,
  max(case when substr(mesh_id,1,7) in ('C03.335','C03.752','C03.858','C17.800') then 1 else 0 end) clus_8,
  max(case when substr(mesh_id,1,7) in ('A10.165','C26.200','G16.100') then 1 else 0 end) clus_9,
  max(case when substr(mesh_id,1,7) in ('F03.875','C10.177','C10','F03.300') then 1 else 0 end) clus_10,
  max(case when substr(mesh_id,1,7) in ('H02.403','N06.230','N01.400','N06.850','C26.733','G16.500') then 1 else 0 end) clus_11,
  max(case when substr(mesh_id,1,7) in ('C11.319','C04.588','C11.941','C11.768') then 1 else 0 end) clus_12,
  max(case when substr(mesh_id,1,7) in ('C02.325','C11.294','C01.539','C11.187') then 1 else 0 end) clus_13,
  max(case when substr(mesh_id,1,7) in ('E05.598','C04.619','C01.703','C04.925','C02.928') then 1 else 0 end) clus_14,
  max(case when substr(mesh_id,1,7) in ('C10.500','C04.700','C16.320','C16.131','C04.651') then 1 else 0 end) clus_15,
  max(case when substr(mesh_id,1,7) in ('C10.720','C10.114','C10.314','C05.550','C10.228','C17.300','C02.182','C05.799','C25.723','C02.081','C20.111','C02.290') then 1 else 0 end) clus_16,
  max(case when substr(mesh_id,1,7) in ('C18.654','F01.700','F03.087','E01.370','C10.228','G07.700','E05.041','C10.597','C10.574','N06.850','C23.888','G07.100') then 1 else 0 end) clus_17,
  max(case when substr(mesh_id,1,7) in ('C07.650','C07.678','C16.131','C05.660','C05.500','C05.651','C07.320','C05.550') then 1 else 0 end) clus_18,
  max(case when substr(mesh_id,1,7) in ('C26.819','C26.915','C26.260','C10.900','C10.228') then 1 else 0 end) clus_19,
  max(case when substr(mesh_id,1,7) in ('C23.550','C14.280','C14.907') then 1 else 0 end) clus_20,
  max(case when substr(mesh_id,1,7) in ('C09.218','C11.525','C11.744','C11.510','C11.966','C10.597','C23.888') then 1 else 0 end) clus_21,
  max(case when substr(mesh_id,1,7) in ('C05.321','C05.360','C17.800','C05.330') then 1 else 0 end) clus_22,
  max(case when substr(mesh_id,1,7) in ('C26','C26.974') then 1 else 0 end) clus_23,
  max(case when substr(mesh_id,1,7) in ('F03.550','F03.700','F03.675','F03') then 1 else 0 end) clus_24,
  max(case when substr(mesh_id,1,7) in ('C23.550','C15.378','G12.425','C20.841','C23.888') then 1 else 0 end) clus_25,
  max(case when substr(mesh_id,1,7) in ('F02.830','G11.561','H01.158','F04.096','E02.190') then 1 else 0 end) clus_26,
  max(case when substr(mesh_id,1,7) in ('C07.465','C07.550','C09.775','C07.793') then 1 else 0 end) clus_27,
  max(case when substr(mesh_id,1,7) in ('C10.668','C26.874','C05.651') then 1 else 0 end) clus_28,
  max(case when substr(mesh_id,1,7) in ('C06.130','C23.300') then 1 else 0 end) clus_29,
  max(case when substr(mesh_id,1,7) in ('C18.452','C19.246') then 1 else 0 end) clus_30,
  max(case when substr(mesh_id,1,7) in ('C04.692','C04.697','C23.550') then 1 else 0 end) clus_31,
  max(case when substr(mesh_id,1,7) in ('C01.539','C01.252') then 1 else 0 end) clus_32,
  max(case when substr(mesh_id,1,7) in ('C16.131','C14.240') then 1 else 0 end) clus_33,
  max(case when substr(mesh_id,1,7) in ('C08.730','C08.460','C01.539','C09.603') then 1 else 0 end) clus_34,
  max(case when substr(mesh_id,1,7) in ('C15.378','C04.557','C15.604','C19.391','C04.588','C20.683','C06.689','C06.301','C19.344','C16.614','C06.405') then 1 else 0 end) clus_35,
  max(case when substr(mesh_id,1,7) in ('C04.588','C08.381','C20.543','C08.785','C08.674','C08.127') then 1 else 0 end) clus_36,
  max(case when substr(mesh_id,1,7) in ('C04.588','C12.294','C13.351','C12.758') then 1 else 0 end) clus_37,
  max(case when substr(mesh_id,1,7) in ('C13.351','C12.777') then 1 else 0 end) clus_38
from condition_browse join mesh_thesaurus using (mesh_term)
group by nct_id;

create index conditions_clusters_nct_id_idx on conditions_clusters(nct_id);